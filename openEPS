#!/bin/bash
#
# Launch an EPS job.
#
#
# Authors: pirkka.ollinaho@fmi.fi
#          juha.lento@csc.fi

# Run options
#
export NAME=parameter_estimation
export MODEL=oifs
export HOST=ollin

# Import correct settings
#
source examples/${MODEL}/configs/exp.$NAME # Experiment specific settings
source examples/${MODEL}/configs/env.$HOST # Environment specific settings

# Broadcast general
#
printf '\n%s\n'   "OpenEPS `git tag | tail -n1`"
printf '\n%s'     "Running an ensemble of $((ENS+1))-members for ${MODEL}."
printf '\n%s\n\n' "Start date for ensemble is $SDATE and end date $EDATE"

# Check that all vital paths/executables exist
#
source bin/util_test.bash

# Initialize
#
source bin/util_init.bash

# Launch bash/batch job
#
cd $WORK
printf "\n3) Submitting job...\n"
#sbatch scripts/job.bash 
bash main.bash &
printf "   ...done! Launcher exiting...\n\n"

exit 1
