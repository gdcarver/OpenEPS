#!/bin/bash
#
# Launch an EPS job. Period.
#
#
# Authors: pirkka.ollinaho@fmi.fi
#          juha.lento@csc.fi

# Run options
#
export NAME=test
export MODEL=testcase
export HOST=$(hostname | cut -c 1-5)

# Import correct settings
#
source sources/${MODEL}/exp.$NAME # Experiment specific settings
source sources/${MODEL}/env.$HOST # Environment specific settings

# Broadcast general
#
printf '\n%s\n'   "OpenEPS `git tag | tail -n1`"
printf '\n%s'     "Running an ensemble of $ENS-members for ${MODEL^^}."
printf '\n%s\n\n' "Start date for ensemble is $SDATE and end date $EDATE"

# Check that all vital paths/executables exist
#
source scripts/general_test.bash

# Initialize
#
source scripts/general_init.bash


# Launch bash/batch job
#
cd $WORK
printf "\n3) Submitting job...\n"
#sbatch scripts/job.bash 
bash scripts/main.bash &
printf "   ...done! Launcher exiting...\n\n"

exit 1
